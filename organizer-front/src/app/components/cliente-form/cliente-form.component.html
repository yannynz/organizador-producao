<div class="modal d-block" tabindex="-1" style="background: rgba(0,0,0,0.5); overflow-y: auto;">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{cliente.id ? 'Editar' : 'Novo'}} Cliente</h5>
        <button type="button" class="btn-close" (click)="cancel.emit()"></button>
      </div>
      <div class="modal-body">
        
        <div class="row">
          <!-- Coluna da Esquerda: Dados Cadastrais -->
          <div class="col-md-5 border-end">
            <h6 class="text-primary mb-3"><i class="bi bi-person-badge"></i> Dados Principais</h6>
            
            <div class="mb-3">
              <label class="form-label fw-bold">Nome Oficial *</label>
              <input type="text" class="form-control" [(ngModel)]="cliente.nomeOficial" required>
            </div>
            
            <div class="mb-3">
              <label class="form-label">Apelidos (Busca)</label>
              <input type="text" class="form-control form-control-sm" [(ngModel)]="cliente.apelidos" placeholder="Ex: Filial X">
            </div>

            <div class="row g-2 mb-3">
              <div class="col-6">
                <label class="form-label">CNPJ / CPF</label>
                <input type="text" class="form-control form-control-sm" [(ngModel)]="cliente.cnpjCpf">
              </div>
              <div class="col-6">
                <label class="form-label">Insc. Estadual</label>
                <input type="text" class="form-control form-control-sm" [(ngModel)]="cliente.inscricaoEstadual">
              </div>
            </div>

            <h6 class="text-primary mt-4 mb-3"><i class="bi bi-headset"></i> Contato Geral</h6>
            <div class="mb-2">
              <label class="form-label">Telefone</label>
              <input type="text" class="form-control form-control-sm" [(ngModel)]="cliente.telefone">
            </div>
            <div class="mb-2">
              <label class="form-label">Email</label>
              <input type="email" class="form-control form-control-sm" [(ngModel)]="cliente.emailContato">
            </div>

            <h6 class="text-primary mt-4 mb-3"><i class="bi bi-truck"></i> Logística Global</h6>
             <div class="mb-2">
                <label class="form-label">Transportadora Padrão</label>
                <select class="form-select form-select-sm" [(ngModel)]="cliente.transportadoraId">
                  <option [ngValue]="undefined">Nenhuma</option>
                  <option *ngFor="let t of transportadoras" [value]="t.id">{{t.nomeOficial}}</option>
                </select>
             </div>
             <div class="row g-2">
                <div class="col-6">
                  <label class="form-label">Padrão Entrega</label>
                  <select class="form-select form-select-sm" [(ngModel)]="cliente.padraoEntrega">
                    <option [ngValue]="undefined">-</option>
                    <option value="RETIRA">Retira</option>
                    <option value="A_ENTREGAR">A Entregar</option>
                  </select>
                </div>
                <div class="col-6">
                   <label class="form-label">Horário Func.</label>
                   <input type="text" class="form-control form-control-sm" [(ngModel)]="cliente.horarioFuncionamento">
                </div>
             </div>

             <div class="form-check mt-3">
                <input class="form-check-input" type="checkbox" [(ngModel)]="cliente.ativo" id="ativoCheck">
                <label class="form-check-label" for="ativoCheck">Cadastro Ativo</label>
              </div>
          </div>

          <!-- Coluna da Direita: Endereços -->
          <div class="col-md-7">
            <div class="d-flex justify-content-between align-items-center mb-3">
               <h6 class="text-primary mb-0"><i class="bi bi-geo-alt"></i> Endereços de Entrega</h6>
               <button class="btn btn-sm btn-success" (click)="addEndereco()"><i class="bi bi-plus"></i> Adicionar</button>
            </div>

            <div class="d-flex flex-column gap-3" style="max-height: 600px; overflow-y: auto;">
               <div *ngFor="let e of cliente.enderecos; let i = index" class="card bg-light border-0 shadow-sm">
                  <div class="card-body p-3">
                     <div class="d-flex justify-content-between mb-2">
                        <div class="form-check">
                           <input class="form-check-input" type="radio" name="defaultAddr" [checked]="e.isDefault" (change)="setDefault(i)">
                           <label class="form-check-label small fw-bold">Endereço Principal</label>
                        </div>
                        <button class="btn btn-sm text-danger p-0" (click)="removeEndereco(i)" title="Remover">
                           <i class="bi bi-trash"></i>
                        </button>
                     </div>
                     
                     <div class="row g-2 mb-2">
                        <div class="col-md-9">
                           <input type="text" class="form-control form-control-sm" placeholder="Logradouro, Número" [(ngModel)]="e.logradouro">
                        </div>
                        <div class="col-md-3">
                           <input type="text" class="form-control form-control-sm" placeholder="CEP" [(ngModel)]="e.cep">
                        </div>
                     </div>
                     <div class="row g-2 mb-2">
                        <div class="col-md-5">
                           <input type="text" class="form-control form-control-sm" placeholder="Bairro" [(ngModel)]="e.bairro">
                        </div>
                        <div class="col-md-5">
                           <input type="text" class="form-control form-control-sm" placeholder="Cidade" [(ngModel)]="e.cidade">
                        </div>
                        <div class="col-md-2">
                           <input type="text" class="form-control form-control-sm" placeholder="UF" [(ngModel)]="e.uf" maxlength="2">
                        </div>
                     </div>
                     <div class="row g-2">
                         <div class="col-md-6">
                            <input type="text" class="form-control form-control-sm" placeholder="Horário Esp. (Opcional)" [(ngModel)]="e.horarioFuncionamento">
                         </div>
                         <div class="col-md-6">
                             <select class="form-select form-select-sm" [(ngModel)]="e.padraoEntrega">
                               <option [ngValue]="undefined">Padrão do Cliente</option>
                               <option value="RETIRA">Retira</option>
                               <option value="A_ENTREGAR">A Entregar</option>
                             </select>
                         </div>
                     </div>
                  </div>
               </div>
               
               <div *ngIf="!cliente.enderecos || cliente.enderecos.length === 0" class="text-center text-muted py-4">
                  Nenhum endereço cadastrado.
               </div>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer bg-light">
        <button type="button" class="btn btn-secondary" (click)="cancel.emit()">Cancelar</button>
        <button type="button" class="btn btn-primary px-4" (click)="submit()" [disabled]="!cliente.nomeOficial">
           <i class="bi bi-check-lg"></i> Salvar Alterações
        </button>
      </div>
    </div>
  </div>
</div>
